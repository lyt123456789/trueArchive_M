<html xmlns:v>
<head>
	
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>xjwGraphDemo</title>
	<link rel="stylesheet" type="text/css" href="flow/themes/default/easyui.css">
	<link href="flow/css/flowPath.css" type="text/css" rel="stylesheet" />
	<STYLE>
		v\:*{behavior:url(#default#VML);}
	</STYLE>

</head>

<body class="easyui-layout bodySelectNone" id="body" onselectstart="return false">

	<iframe style="display:none;" name ="postIframe"></iframe>
	<form method="post" id="postForm" name="postForm" style="display:none;" action="http://192.168.7.56:8082/trueWorkflow/mobileTerminalInterface_addWfDefineForImaging.do">
		<input type="text" name="xml" id="xml" />
	</form>
	
	<div id="title" region="north" split="true" border="false" title="工具栏" class="titleTool">
		<img alt="撤销"	title="撤销" src="flow/images/back.png" onClick="graphUtils.undo();" class="buttonStyle"/>
		<img alt="重做"	title="重做" src="flow/images/next.png" onClick="graphUtils.redo();" class="buttonStyle"/>
		<img alt="保存"	title="保存" src="flow/images/save.png" onClick="graphUtils.saveXml();" class="buttonStyle"/>
		<img alt="加载"	title="加载" src="flow/images/download_page.png" onClick="graphUtils.loadXml();" class="buttonStyle"/>
		<select id="flowid" style="position: relative;left: 5px;top: -9px;"></select>
	</div>
	
	<div id="leftContent" region="west" split="true" title="图元区" class="leftContent">
					
		<div id="baseLine2" style="position:absolute;left:10px;top:10px !important;top:10px">
				<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/line1.png" class="nodeStyle"/>
		</div>
		<div id="baseLine3" style="position:absolute;left:50px;top:10px !important;top:10px">
			<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/line2.png" class="nodeStyle"/>
		</div>
		<div id="baseLine1" style="position:absolute;left:90px;top:10px !important;top:10px">
			<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/line3.png" class="nodeStyle"/>
		</div>
		<div id="baseLine5" style="position:absolute;left:10px;top:50px !important;top:50px">
				<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/line4.png" class="nodeStyle"/>
		</div>
		<div id="baseLine6" style="position:absolute;left:50px;top:50px !important;top:50px">
			<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/line5.png" class="nodeStyle"/>
		</div>
		<div id="baseLine4" style="position:absolute;left:90px;top:50px !important;top:50px">
			<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/line6.png" class="nodeStyle"/>
		</div>
		<div id="start" divType="mode" style="position:absolute;left:10px;top:90px !important;top:90px">
			<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/baseMode1.png" class="nodeStyle"/>
		</div>
		<div id="baseMode5" divType="mode" style="position:absolute;left:50px;top:90px !important;top:90px">
			<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/baseMode2.png" class="nodeStyle"/>
		</div>
		<div id="baseMode6" divType="mode" style="position:absolute;left:90px;top:90px !important;top:90px">
			<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/baseMode3.png" class="nodeStyle"/>
		</div>
		<div id="end" divType="mode" style="position:absolute;left:10px;top:130px !important;top:130px">
			<div class="title">&nbsp;</div>
			<img id="backGroundImg" src="flow/images/baseMode4.png" class="nodeStyle"/>
		</div>
			
	</div>
	
	<div region="center" title="绘图区" id="contextBody" class="mapContext" >
			
		<!-- Line右键菜单 -->
		<div id="lineRightMenu" class="modeRight">
			<div class="modeRightTop"></div>
			<div class="modeRightDel" onMouseMove="this.style.backgroundColor='#c5e7f6'" onClick="graphUtils.removeNode();" onMouseOut="this.style.backgroundColor=''"><span class="menuSpan">删 除</span></div>
			<div class="modeRightPro" onMouseMove="this.style.backgroundColor='#c5e7f6'" onClick="graphUtils.showLinePro();" onMouseOut="this.style.backgroundColor=''"><span class="menuSpan">属 性</span></div>
			<div class="modeRightButtom"></div>
		</div>
				
		<!-- Mode右键菜单 -->
		<div id="rightMenu" class="modeRight">
			<div class="modeRightTop"></div>
			<div class="modeRightDel" onMouseMove="this.style.backgroundColor='#c5e7f6'" onClick="graphUtils.removeNode();" onMouseOut="this.style.backgroundColor=''"><span class="menuSpan">删 除</span></div>
			<div class="modeRightPro" onMouseMove="this.style.backgroundColor='#c5e7f6'" onClick="graphUtils.showModePro();" onMouseOut="this.style.backgroundColor=''"><span class="menuSpan">属 性</span></div>
			<div class="modeRightButtom"></div>
		</div>
		
		<!-- PathBody右键菜单 -->
		<div id="pathBodyRightMenu" class="modeRight">
			<div class="modeRightTop"></div>
			<div class="modeRightPro" id="isPixel" onClick="graphUtils.showProcessPro();" onMouseMove="this.style.backgroundColor='#c5e7f6'" onMouseOut="this.style.backgroundColor=''"><span class="menuSpan">属 性</span></div>
			<div class="modeSave" onClick="graphUtils.saveXml();" onMouseMove="this.style.backgroundColor='#c5e7f6'" onMouseOut="this.style.backgroundColor=''"><span class="menuSpan">保 存</span></div>
			<div class="modeUndo" onClick="graphUtils.undo();" onMouseMove="this.style.backgroundColor='#c5e7f6'" onMouseOut="this.style.backgroundColor=''"><span class="menuSpan">撤 销</span></div>
			<div class="modeRedo" onClick="graphUtils.redo();" onMouseMove="this.style.backgroundColor='#c5e7f6'" onMouseOut="this.style.backgroundColor=''"><span class="menuSpan">重 做</span></div>
			<div class="modeRightButtom"></div>
		</div>
		
	 	<div id="topCross"></div>
    	<div id="leftCross"></div>
	
	</div>
	
	<!-- 移动时的图象 -->
	<div id="moveBaseMode" class="moveBaseMode">
		<img id="moveBaseModeImg"  src="flow/images/Favourite.png" class="nodeStyle"/>
	</div>
	
	<div id="prop" style="visibility: hidden;">
				Dialog Content.  
	</div>
	
	</body>
	
	<script src="flow/js/jquery-1.6.min.js" type="text/javascript"></script>
	<script src="flow/js/jquery.easyui.min.js" type="text/javascript"></script>
	<script src="flow/js/strawberry.js" type="text/javascript" language="javascript"></script>
	
	<script>
		var global = com.xjwgraph.Global;

		$("#flowid").bind("change",function(){
			global.baseBase.prop.flow_id = this.value;
			console.log(this.value);
			console.log(global.baseBase)
		})
  		
		jQuery(document).ready(function () {

			$.ajax({
				type: "get",
				dataType: "json",
				url: "flow.php",
				success: function(msg){
					global.parameter = msg;
				}
			})
			
			graphUtils = com.xjwgraph.Utils.create({
				
				contextBody : 'contextBody',
				width : 1600,
				height : 1000,
				smallMap : 'smallMap',
				mainControl : 'mainControl',
				prop : 'prop'
			
			});
			
			graphUtils.nodeDrag($id("baseLine1"), true, 1);
			graphUtils.nodeDrag($id("baseLine2"), true, 2);
			graphUtils.nodeDrag($id("baseLine3"), true, 3);
			graphUtils.nodeDrag($id("baseLine4"), true, 4);
			graphUtils.nodeDrag($id("baseLine5"), true, 5);
			graphUtils.nodeDrag($id("baseLine6"), true, 6);

			var modes = jQuery("[divType='mode']");
			var modeLength = modes.length;
			
			for (var i = 0; i < modeLength; i++) {
				graphUtils.nodeDrag(modes[i]);
			}
			
			document.body.onclick = function () {

				if (!stopEvent) {
					global.modeTool.clear();
				} 
				
			}

			document.onkeydown = KeyDown;

			graphUtils.loadTextXml('<?xml version="1.0"?><flow><flow_name>6</flow_name><flow_create_time>2013-4-2 15:14</flow_create_time><flow_modified_time></flow_modified_time><flow_work_calendar>1</flow_work_calendar><flow_initiate_tasks>1</flow_initiate_tasks><flow_default_query_form>0</flow_default_query_form><flow_id></flow_id><flow_seq><nodetype></nodetype><node_name></node_name><node_create_time>2013-4-3 15:8</node_create_time><node_modified_time></node_modified_time><node_dead_line></node_dead_line><node_dead_line_unit></node_dead_line_unit><node_initiate_tasks></node_initiate_tasks><node_global_process_custom></node_global_process_custom><node_current_process_custom></node_current_process_custom><node_default_calendar></node_default_calendar><node_default_form></node_default_form><node_default_template></node_default_template><node_allow_consultation></node_allow_consultation><node_allow_delegation>true</node_allow_delegation><node_allow_cc>true</node_allow_cc><node_staff></node_staff><class>module</class><id>module34</id><backImgSrc>http://192.168.7.56/flow/flow/images/baseMode4.png</backImgSrc><top>486</top><left>326</left><zIndex>34</zIndex><width>50</width><height>50</height></flow_seq><flow_seq><nodetype></nodetype><node_name></node_name><node_create_time>2013-4-3 15:8</node_create_time><node_modified_time></node_modified_time><node_dead_line></node_dead_line><node_dead_line_unit></node_dead_line_unit><node_initiate_tasks></node_initiate_tasks><node_global_process_custom></node_global_process_custom><node_current_process_custom></node_current_process_custom><node_default_calendar></node_default_calendar><node_default_form></node_default_form><node_default_template></node_default_template><node_allow_consultation></node_allow_consultation><node_allow_delegation>true</node_allow_delegation><node_allow_cc>true</node_allow_cc><node_staff></node_staff><class>module</class><id>module32</id><backImgSrc>http://192.168.7.56/flow/flow/images/baseMode3.png</backImgSrc><top>247</top><left>524</left><zIndex>32</zIndex><width>50</width><height>50</height></flow_seq><flow_seq><nodetype></nodetype><node_name></node_name><node_create_time>2013-4-3 15:8</node_create_time><node_modified_time></node_modified_time><node_dead_line></node_dead_line><node_dead_line_unit></node_dead_line_unit><node_initiate_tasks></node_initiate_tasks><node_global_process_custom></node_global_process_custom><node_current_process_custom></node_current_process_custom><node_default_calendar></node_default_calendar><node_default_form></node_default_form><node_default_template></node_default_template><node_allow_consultation></node_allow_consultation><node_allow_delegation>true</node_allow_delegation><node_allow_cc>true</node_allow_cc><node_staff></node_staff><class>module</class><id>module30</id><backImgSrc>http://192.168.7.56/flow/flow/images/baseMode2.png</backImgSrc><top>77</top><left>326</left><zIndex>30</zIndex><width>50</width><height>50</height></flow_seq><flow_seq><nodetype>start</nodetype><node_name></node_name><node_create_time>2013-4-3 15:8</node_create_time><node_modified_time></node_modified_time><node_dead_line></node_dead_line><node_dead_line_unit></node_dead_line_unit><node_initiate_tasks></node_initiate_tasks><node_global_process_custom></node_global_process_custom><node_current_process_custom></node_current_process_custom><node_default_calendar></node_default_calendar><node_default_form></node_default_form><node_default_template></node_default_template><node_allow_consultation></node_allow_consultation><node_allow_delegation>true</node_allow_delegation><node_allow_cc>true</node_allow_cc><node_staff></node_staff><class>module</class><id>module28</id><backImgSrc>http://192.168.7.56/flow/flow/images/baseMode1.png</backImgSrc><top>23</top><left>74</left><zIndex>28</zIndex><width>50</width><height>50</height></flow_seq><flow_line><id>line30</id><wBaseMode>module34</wBaseMode><wIndex>2</wIndex><xBaseMode>module32</xBaseMode><xIndex>7</xIndex><line_route_type></line_route_type><line_fixed_role></line_fixed_role><line_conditions></line_conditions><line_arrow>2</line_arrow><marker-end>true</marker-end><d>M 550 299 L 550 392,352 392,352 486</d><brokenType>2</brokenType></flow_line><flow_line><id>line28</id><wBaseMode>module32</wBaseMode><wIndex>4</wIndex><xBaseMode>module30</xBaseMode><xIndex>5</xIndex><line_route_type></line_route_type><line_fixed_role></line_fixed_role><line_conditions></line_conditions><line_arrow>2</line_arrow><marker-end>true</marker-end><d>M 378 103 L 450 103,450 273,524 273</d><brokenType>3</brokenType></flow_line><flow_line><id>line26</id><wBaseMode>module30</wBaseMode><wIndex>4</wIndex><xBaseMode>module28</xBaseMode><xIndex>5</xIndex><line_route_type></line_route_type><line_fixed_role></line_fixed_role><line_conditions></line_conditions><line_arrow>2</line_arrow><marker-end>true</marker-end><d>M 126 49 L 225 49,225 103,326 103</d><brokenType>3</brokenType></flow_line></flow>');
		});
		
	</script>

</html>